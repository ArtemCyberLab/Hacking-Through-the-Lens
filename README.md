This project details the process of hacking the CyberLens CTF challenge on TryHackMe, covering reconnaissance, vulnerability exploitation, and privilege escalation. I conducted a host scan using Nmap: nmap -sV -sC cyberlens.thm -vv, discovering open ports 80 (HTTP), 135, 139, 445 (SMB), and 3389 (RDP). I focused on port 445, but running enum4linux yielded no results. I started an RDP brute-force attack in the background while manually exploring the web server using GoBuster and Nikto. In the page source, I found a JavaScript snippet making a request to http://cyberlens.thm:61777/meta, which led me to an Apache Tika 1.7 server vulnerable to CVE-2018–1335 (RCE). I decided to upload a shell through the file upload tool and execute it using this exploit. In Metasploit, I found the windows/http/apache_tika_jp2_jscript module, which automated the process. After setting SRVHOST to my THM IP, I successfully gained access to the system as CYBERLENS\CyberLens and retrieved the flag from C:\Users\CyberLens\Desktop\user.txt. Running getsystem in Meterpreter didn’t work, and Mimikatz wasn’t helpful, so I used the local exploit suggester. After several attempts, I escalated privileges to SYSTEM and retrieved the final flag from C:\Users\Administrator\Desktop\admin.txt. The challenge was engaging, even though it didn’t fully align with the skills I aimed to practice.
